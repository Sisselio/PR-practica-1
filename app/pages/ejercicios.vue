<template>
  <!-- üìò Ejercicio 1: Mostrar mensaje din√°mico

Enunciado: Crea una p√°gina en Nuxt 3 que muestre un mensaje dentro de un p√°rrafo. Cambia el texto del mensaje utilizando ref dentro del setup().

Crea un archivo en pages (por ejemplo, mensaje.vue).

Define una variable mensaje como un ref dentro del setup().

Muestra el valor de mensaje en un p√°rrafo. -->

  <!-- <div id="ej1">
    <h1>Ejercicio 1</h1>
    <p>{{ mensaje }}</p>
  </div> -->

  <!-- üìò Ejercicio 2: Bot√≥n que cambia el mensaje

Enunciado: En la misma p√°gina que en el ejercicio anterior, agrega un bot√≥n. Cuando se haga clic, el mensaje debe cambiar a otro valor.

Crea un bot√≥n que ejecute una funci√≥n que cambie el valor de la variable mensaje.

Usa un m√©todo dentro del setup() para actualizar el mensaje. -->

  <!-- <div id="ej2">
    <h1>Ejercicio 2</h1>
    <p>Frase: {{ frase }}</p>
    <button @click="() => (frase = nuevaFrase)">Cambiar frase</button>
  </div> -->

  <!-- üìò Ejercicio 3: Contador con botones

Enunciado: Implementa un contador en una p√°gina de Nuxt 3 con dos botones: uno para aumentar el contador y otro para disminuirlo.

Crea un ref llamado contador que almacene el valor del contador.

Usa dos botones:

Un bot√≥n para aumentar el valor de contador.

Un bot√≥n para disminuir el valor de contador. -->

  <!-- <div id="ej3">
    <h1>Ejercicio 3</h1>
    <p>Contador: {{ contador1 }}</p>
    <button @click="() => contador++">Aumentar contador</button>
    <button @click="() => contador--">Disminuir contador</button>
  </div> -->

  <!-- üìò Ejercicio 4: Mostrar u ocultar texto

Enunciado: Usa una variable booleana para mostrar u ocultar un p√°rrafo con un bot√≥n. El texto debe mostrarse u ocultarse cada vez que se haga clic en el bot√≥n.

Crea un ref llamado mostrar que sea de tipo boolean.

En el template, muestra u oculta el p√°rrafo utilizando v-if seg√∫n el valor de mostrar.

El bot√≥n debe cambiar el valor de mostrar entre true y false. -->

  <!-- <div id="ej4">
    <h1>Ejercicio 4</h1>
    <p v-if="isVisible">Visible</p>
    <button @click="Visibilidad()">Cambiar visibilidad</button>
  </div>
  <div id="ej4">
    <h1>Ejercicio 4</h1>
    <p v-show="isVisible">Visible</p>
    <button @click="Visibilidad()">Cambiar visibilidad</button>
  </div> -->

  <!-- üìò Ejercicio 5: Lista de frutas con v-for

Enunciado: Muestra una lista de frutas usando v-for y una variable ref en el setup().

Crea un ref llamado frutas que contenga un array con al menos 4 frutas.

En el template, muestra todas las frutas dentro de una lista (

) usando v-for.
Cada elemento de la lista debe ser un

que contenga el nombre de la fruta. -->

  <!-- <div id="ej5">
    <h1>Ejercicio 5</h1>
    <ul>
      <li v-for="fruta in frutas">
        {{ fruta }}
      </li>
    </ul>
    <ul>
      <li v-for="fruta in frutasSimples">
        {{ fruta.fruta }}
      </li>
    </ul>
  </div> -->

  <!-- ‚úÖ Ejercicio 6: Input con v-model y mensaje en vivo

Enunciado
Crea una p√°gina con un campo de texto (input) donde el usuario pueda escribir su nombre. 
Al mismo tiempo, muestra un mensaje en vivo que diga:
"Hola, [nombre]"

Requisitos:

Usa v-model para enlazar el input con una variable reactiva.

Usa interpolaci√≥n para mostrar el mensaje en tiempo real. -->

  <!-- <div id="ej6">
    <form action="#">
      <h1>Ejercicio 6</h1>
      <label for="nombre"
        >Nombre: <span>{{ modelValue.name }}</span></label
      ><br />
      <input type="text" v-model="modelValue.name" />
    </form>
  </div> -->

  <!-- ‚úÖ Ejercicio 7: Lista de tareas con a√±adir y eliminar

Enunciado
Crea una lista de tareas con un input y dos botones:

Un bot√≥n para a√±adir una tarea nueva.

Un bot√≥n junto a cada tarea para eliminarla.

Requisitos:

Usa un array de objetos reactivos (ref([])).

Usa v-for para renderizar las tareas.

A√±ade validaci√≥n b√°sica para evitar tareas vac√≠as. -->

  <!-- <div id="ej7">
    <h1>Ejercicio 7</h1>
    <form action="#">
      <label for="tarea">Introduce una tarea: </label><br />
      <input type="text" name="tarea" id="tarea" v-model="tarea" />
      <button type="button" @click="InsertarTarea">Insertar tarea</button>
    </form>
    <ol>
      <li v-for="(tarea, index) in tareas" :key="index">
        {{ tarea }}
        <button @click="EliminarTarea(index)">Eliminar Tarea</button>
      </li>
    </ol>
  </div> -->

  <!-- ‚úÖ Ejercicio 8: Contador con l√≠mites y estilo din√°mico

Enunciado
Crea un contador que tenga un n√∫mero m√≠nimo (0) y m√°ximo (10). Si el contador est√° en el l√≠mite, 
desactiva el bot√≥n correspondiente y cambia el color del n√∫mero seg√∫n el valor:

Verde si est√° entre 1 y 9.

Rojo si est√° en 0 o 10.

Requisitos:

Usa computed para el estilo din√°mico.

Usa :disabled en los botones cuando se alcance un l√≠mite. -->

  <!-- <div id="ej8">
    <h1>Ejercicio 8</h1>
    <p
      :style="contador2 <= 0 || contador2 == 10 ? 'color:red' : 'color:green'"
      :class="['test']"
    >
      Contador: {{ contador2 }}
    </p>
    <button :disabled="contador2 === 0" @click="AdminContador(-1)">
      Disminuir contador
    </button>
    <button :disabled="contador2 === 10" @click="AdminContador(+1)">
      Aumentar contador
    </button>
  </div> -->

  <!-- ‚úÖ Ejercicio 9: Verificar si una palabra es pal√≠ndromo

Enunciado
Crea un input de texto donde el usuario pueda escribir una palabra. Muestra un mensaje que diga 
si la palabra es un pal√≠ndromo (igual al derecho y al rev√©s).

Requisitos:

Usa v-model para el input.

Usa un computed o watch para analizar la palabra.

Ignora may√∫sculas/min√∫sculas. -->

  <!-- <div id="ej9">
    <h1>Ejercicio 9</h1>
    <form action="#">
      <label for="palabra"
        >Introduce una palabra: <span>{{ wordValue.name }}</span></label
      ><br />
      <input type="text" name="palabra" id="palabra" v-model="wordValue.name" />
      <label for="isPalindrome">{{ palindrome }}</label>
    </form>
  </div> -->

  <!-- ‚úÖ Ejercicio 10: Select din√°mico y filtro de productos
Enunciado
Crea una lista de productos con nombre y categor√≠a. Agrega un select con categor√≠as para filtrar los productos. 
Requisitos: Usa un array de productos (nombre y categor√≠a). Usa un computed para mostrar los productos 
filtrados por la categor√≠a seleccionada. Muestra todos si no se ha seleccionado ninguna categor√≠a. -->

  <!-- <div id="ej10">
    <h1>Ejercicio 10</h1>
    <select name="categorias" id="category" v-model="selectedCategory">
      <option value="">Seleccione una categoria</option>
      <option v-for="category in categories" :key="category" :value="category">
        {{ category }}
      </option>
    </select>
    <ul>
      <li v-for="product in filteredProducts" :key="product.name">
        {{ product.name }} - {{ product.category }}
      </li>
    </ul>
  </div> -->

  <!-- ‚úÖ Ejercicio 11: Lista de usuarios con b√∫squeda en vivo

Enunciado
Crea una lista de usuarios y un campo de b√∫squeda. A medida que el usuario escribe, se deben mostrar 
solo los usuarios cuyo nombre coincida parcial o totalmente.

Requisitos:

Usa un array de usuarios con al menos nombre y email.

Usa v-model para enlazar el campo de b√∫squeda.

Usa computed para filtrar la lista en tiempo real.

La b√∫squeda debe ser insensible a may√∫sculas/min√∫sculas. -->

  <!-- <div id="ej11">
    
    <input
      type="text"
      name="Nombre"
      id="palabra"
      v-model="searchName"
      placeholder="Intoduzca un nombre"
    />
    <ul>
      <li v-for="user in users" :key="user.name">
        {{ user.name }} - {{ user.email }}
      </li>
    </ul>
  </div> -->
  <div id="ej11">
    <h1>Ejercicio 11</h1>
    <input
      v-model="searchName"
      type="text"
      placeholder="Buscar por nombre..."
    />

    <ul>
      <li v-for="user in matchingNames" :key="user.email">
        {{ user.name }} - {{ user.email }}
      </li>
    </ul>

    <p v-if="matchingNames.length === 0">No se encontraron usuarios.</p>
  </div>
  <!-- ‚úÖ Ejercicio 12: Formulario de registro con validaci√≥n reactiva

Enunciado
Crea un formulario con los campos: nombre, email y contrase√±a. Muestra mensajes de error en tiempo real 
si el campo no cumple con condiciones m√≠nimas.

Requisitos:

Usa v-model en cada campo.

Valida que:

El nombre tenga al menos 3 caracteres.

El email contenga @.

La contrase√±a tenga al menos 6 caracteres.

Usa computed para mostrar si el formulario est√° listo para enviar.

Desactiva el bot√≥n "Registrar" hasta que todo sea v√°lido. -->
  <div id="ej12">
    <h1>Ejercicio 12</h1>
    <form action="#">
      <label for="name">Nombre: </label>
      <input
        type="text"
        name=""
        id=""
        v-model="inpName"
        @blur="nameTouched = true"
      /><br /><br />
      <p v-if="nameTouched && errorName" @blur="">
        Introduzca un formato de nombre valido
      </p>
      <label for="email">Email: </label>
      <input
        type="text"
        name=""
        id=""
        v-model="inpEmail"
        @blur="emailTouched = true"
      /><br /><br />
      <p v-if="emailTouched && errorEmail">
        Introduzca un formato de email valido
      </p>
      <label for="pwd">Contrase√±a: </label>
      <input
        type="text"
        name=""
        id=""
        v-model="inpPassword"
        @blur="passwordTouched = true"
      /><br /><br />
      <p v-if="passwordTouched && errorPassword">
        Introduzca un formato de contrase√±a valido
      </p>
      <button :disabled="!submitable" type="submit">Enviar</button>
    </form>
  </div>
  <!-- ‚úÖ Ejercicio 13: Contador de caracteres con l√≠mite y advertencia

Enunciado
Crea un textarea para escribir un mensaje con un l√≠mite de 100 caracteres. Muestra en tiempo real cu√°ntos 
caracteres quedan, y cambia el color del contador si se pasa del l√≠mite.

Requisitos:

Usa v-model para enlazar el texto.

Usa computed para calcular los caracteres restantes.

Si se pasa del l√≠mite, muestra el contador en rojo y desactiva el bot√≥n de "Enviar".

Si est√° dentro del l√≠mite, muestra el contador en verde. -->

  <div id="ej13">
    <h1>Ejercicio 13</h1>
    <textarea name="" id="" v-model="textarea"></textarea>
    <p>
      Caracteres usados:
      <span :style="wordsLeft > 100 ? 'color:red' : 'color:green'">
        {{ wordsLeft }}
      </span>
    </p>
    <button :disabled="wordsLeft > 100" type="submit">Enviar</button>
  </div>

  <!-- ‚úÖ Ejercicio 14: Lista de productos con ordenamiento din√°mico

Enunciado
Muestra una lista de productos (nombre y precio) con select un que permita al usuario ordenar por: Precio ascendente 
Precio descendente Nombre alfab√©ticamente Requisitos: Usa un array de productos. Usa v-model en el select.

Usa un computed para ordenar la lista seg√∫n la opci√≥n seleccionada.

Muestra el listado actualizado autom√°ticamente. -->

  <div id="ej14">
    <h1>Ejercicio 14</h1>
    <select name="categorias" id="category" v-model="selectedOrder">
      <option value="">Seleccione un orden</option>
      <option>Precio ascendente</option>
      <option>Precio descendente</option>
      <option>Alfabeticamente</option>
    </select>
    <ul>
      <li v-for="product in orderedProducts" :key="product.name">
        {{ product.name }} - {{ product.price }} ‚Ç¨
      </li>
    </ul>
  </div>

  <!-- ‚úÖ Ejercicio 15: Tabs din√°micos con contenido condicional

Enunciado
Crea una interfaz con 3 pesta√±as (Tabs): Inicio, Perfil, Configuraci√≥n. Seg√∫n la pesta√±a seleccionada, muestra contenido diferente sin recargar la p√°gina.

Requisitos:

Usa un array con los nombres de las pesta√±as.

Usa v-model o ref para saber qu√© pesta√±a est√° activa.

Usa v-if o v-show para mostrar el contenido correspondiente.

Aplica una clase activa al bot√≥n/tab seleccionado. -->

  <div id="ej15">
    <h1>Ejercicio 15</h1>
    <button>Inicio</button>
    <button>Perfil</button>
    <button>Configuraci√≥n</button>
    <div v-if="isInicio">
      <h3>Pesta√±a de inicio</h3>
    </div>
    <div v-if="isPerfil">
      <h3>Pesta√±a de Perfil</h3>
    </div>
    <div v-if="isConfiguraci√≥n">
      <h3>Pesta√±a de Configuraci√≥n</h3>
    </div>
  </div>
</template>

<!-- Codigo -->

<script setup>
import { ref, watch, computed } from "vue";
// Ejercicio 1
const mensaje = ref("Ejercicio 1");
// Ejercicio 2
const contador1 = ref(0);
// Ejercicio 3
const frase = ref("Hola");
const nuevaFrase = ref("Adios");
// Ejercicio 4
const isVisible = ref(true);
function Visibilidad() {
  isVisible.value = !isVisible.value;
}
// Ejercicio 5
const frutasSimples = ref([{ fruta: "Manzana" }, { fruta: "Pera" }]);
const frutas = ref(["Manzana", "Pera", "Platano", "Mango"]);
// Ejercicio 6
const modelValue = ref({
  name: "",
});
// Ejercicio 7
const tarea = ref("");
const tareas = ref([]);
function InsertarTarea() {
  if (tarea.value != "") {
    tareas.value.push(tarea.value);
    tarea.value = "";
  } else {
    alert("rellene los campos");
  }
}
function EliminarTarea(index) {
  tareas.value.splice(index, 1);
}
// Ejercicio 8
let contador2 = ref(5);
function AdminContador(num) {
  contador2.value += num;
}

// Ejercicio 9
const wordValue = ref({
  name: "",
});
const palindrome = ref("");
function isPalindrome(str) {
  const re = /[\W_]/;
  const cleanStr = str.toLowerCase().replace(re, "");
  return cleanStr === cleanStr.split("").reverse().join("");
}
function checkIsPalindrome() {
  if (isPalindrome(wordValue.value.name)) {
    palindrome.value = "  Es palindromo";
  } else {
    palindrome.value = "  No es palindromo";
  }
}
watch(() => wordValue.value.name, checkIsPalindrome);
// Ejercicio 10
const products = ref([
  { name: "Ordenador", category: "Electr√≥nica" },
  { name: "Movil", category: "Electr√≥nica" },
  { name: "Camiseta", category: "Ropa" },
  { name: "Pantal√≥n", category: "Ropa" },
  { name: "Mesa", category: "Hogar" },
]);
const selectedCategory = ref("");
const categories = computed(() => {
  // esto crea un array con solo las categorias
  const allCategories = products.value.map((p) => p.category);
  // y esto con set quita los repetidos y al poner ... delante lo reconvierte a un array normal(por alguna razon(que no entiendo))
  return [...new Set(allCategories)];
});
const filteredProducts = computed(() => {
  if (!selectedCategory.value) {
    return products.value;
  }
  return products.value.filter(
    // esto hace que el resultado sean los elementos del array que coincieden con lo seleccionado en el select
    (product) => product.category === selectedCategory.value
  );
});
// Ejercicio 11
const users = ref([
  { name: "Ana Torres", email: "ana.torres@example.com" },
  { name: "Luis P√©rez", email: "luis.perez@example.com" },
  { name: "Carlos G√≥mez", email: "carlos.gomez@example.com" },
  { name: "Luc√≠a Mart√≠nez", email: "lucia.martinez@example.com" },
  { name: "Elena R√≠os", email: "elena.rios@example.com" },
]);

const searchName = ref("");

const matchingNames = computed(() => {
  const match = searchName.value.trim().toLowerCase();
  if (!match) {
    return users.value;
  } else {
    return users.value.filter((user) =>
      user.name.toLowerCase().startsWith(match)
    );
  }
});
// Ejercicio 12
const inpName = ref("");
const inpEmail = ref("");
const inpPassword = ref("");
const errorName = ref(false);
const errorEmail = ref(false);
const errorPassword = ref(false);
const nameTouched = ref(false);
const emailTouched = ref(false);
const passwordTouched = ref(false);

const validName = computed(() => {
  const isValid = inpName.value.trim().length >= 3;
  errorName.value = !isValid;
  return isValid;
});

const validEmail = computed(() => {
  const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
  const isValid = emailRegex.test(inpEmail.value);
  errorEmail.value = !isValid;
  return isValid;
});

const validPassword = computed(() => {
  const isValid = inpPassword.value.length >= 6;
  errorPassword.value = !isValid;
  return isValid;
});

const submitable = computed(() => {
  return validName.value && validEmail.value && validPassword.value;
});
// Ejercicio 13
const textarea = ref("");
const wordsLeft = computed(() => {
  return textarea.value.length;
});
// Ejercicio 14
const electronicProducts = ref([
  { name: "Portatil", price: 1200 },
  { name: "Teclado", price: 40 },
  { name: "Raton", price: 25 },
  { name: "Monitor", price: 300 },
  { name: "Movil", price: 800 },
]);
const selectedOrder = ref("");
function sortPrizesUp(a, b) {
  return a.price - b.price;
}
function sortPrizesDown(a, b) {
  return b.price - a.price;
}
function sortNames(a, b) {
  return a.name.localeCompare(b.name);
}
function sortedUp() {
  const sorted = [...electronicProducts.value].sort(sortPrizesUp);
  return sorted.map(toRaw);
}
function sortedDown() {
  const sorted = [...electronicProducts.value].sort(sortPrizesDown);
  return sorted.map(toRaw);
}
function sortedAlphabeticaly() {
  const sorted = [...electronicProducts.value].sort(sortNames);
  return sorted.map(toRaw);
}

const orderedProducts = computed(() => {
  if (!selectedOrder.value) {
    return electronicProducts.value;
  } else if (selectedOrder.value == "Precio ascendente") {
    return sortedUp();
  } else if (selectedOrder.value == "Precio descendente") {
    return sortedDown();
  } else if (selectedOrder.value == "Alfabeticamente") {
    return sortedAlphabeticaly();
  }
});
// Ejercicio 15
</script>
